---
import Layout from "../layouts/Layout.astro";
import CandidateList from "../components/candidate/CandidateList.vue";
import { getCandidates } from "../data/get_candidates";
import { getLocationMap, getProvinceList } from "../data/senate_option.ts";
import { ApplicationGroup } from "../data/application_group.ts";
import type { CandidateOverview } from "../data/candidate";

const highlightStandpoints = [
	"เขียนรัฐธรรมนูญใหม่ “ทั้งฉบับ”",
	"เขียนรัฐธรรมนูญใหม่ แต่ยกเว้นหมวด 1 หมวด 2",
	"ให้มีสภาร่างรัฐธรรมนูญ (สสร.) ใหม่ จากการเลือกตั้ง100%",
	"ยกเลิกสว. ใช้ระบบสภาเดี่ยว",
	"นิรโทษกรรมคดีการเมือง “ทุกคดี”",
];

const candidates: CandidateOverview[] = (await getCandidates())
	.map(({ visionQuestionaires, politicalStances, ...rest }) => ({
		...rest,
		politicalStances: politicalStances.filter(({ statement }) =>
			highlightStandpoints.includes(statement),
		),
	}))
	.sort((a, z) => a.firstName.localeCompare(z.firstName));

const total_candidate = candidates.length;
const application_group = Object.values(ApplicationGroup);
const provinces = getProvinceList();
const districts = getLocationMap();
---

<Layout title="ค้นหาผู้สมัคร สว.">
	<CandidateList
		{candidates}
		{total_candidate}
		{application_group}
		{provinces}
		{districts}
		client:load
	/>
</Layout>
